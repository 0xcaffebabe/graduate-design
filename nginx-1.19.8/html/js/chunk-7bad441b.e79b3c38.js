(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bad441b"],{"2d01":function(e,t,r){"use strict";r("4160"),r("d81d"),r("159b"),r("96cf");var a=r("1da1"),n=r("d4ec"),s=r("bee2"),c=r("c1df"),o=r.n(c),u=r("27de");o.a.locale("zh-cn");var i=function(){function e(){Object(n["a"])(this,e)}return Object(s["a"])(e,[{key:"getOrderDeliveryTime",value:function(){return o()().add(1,"hours").calendar()}},{key:"makeOrder",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=JSON.parse(JSON.stringify(t)),t.deliveryId){e.next=3;break}throw new Error("下单失败:收货信息ID为空");case 3:if(t.productList){e.next=5;break}throw new Error("下单失败:下单商品列表为空");case 5:return t.productList=t.productList.map((function(e){return{productId:e.productId,specId:e.specId,quantity:e.productQuantity}})),e.next=8,u["a"].makeOrder(t);case 8:if(r=e.sent,r.success){e.next=11;break}throw new Error("下单失败:"+r.msg);case 11:return e.abrupt("return",r.data);case 12:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getOrderList",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["a"].getOrderList(t,r);case 2:if(a=e.sent,a.success){e.next=5;break}throw new Error("获取订单列表失败:"+a.msg);case 5:return e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getOrderDetail",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["a"].getOrderDetail(t);case 2:if(r=e.sent,r.success){e.next=5;break}throw new Error("获取订单详情失败:"+r.msg);case 5:return r.data&&r.data.productList&&r.data.productList.forEach((function(e){e.specId=e.productSpec})),e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getOrderStatus",value:function(e){return 0===e.orderStatus?"未处理":1===e.orderStatus?"已处理":2===e.orderStatus?"配送中":3===e.orderStatus?"已完结":4===e.orderStatus?"已作废":void 0}}]),e}();t["a"]=new i},"3b6a":function(e,t,r){"use strict";r("4160"),r("159b"),r("96cf");var a=r("1da1"),n=r("d4ec"),s=r("bee2"),c=r("27de"),o=function(){function e(){Object(n["a"])(this,e)}return Object(s["a"])(e,[{key:"addProduct",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].addProductIntoCart(t);case 2:if(r=e.sent,r.success){e.next=5;break}throw new Error("加入购物车失败:"+r.msg);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getProductList",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].getCartProductList(t);case 2:if(r=e.sent,r.success){e.next=5;break}throw new Error("获取购物车商品列表失败:"+r.msg);case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCartTotal",value:function(e){if(!e)return 0;var t=0;return e.forEach((function(e){t+=e.productQuantity})),t}},{key:"clearCart",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].clearCart(t);case 2:return r=e.sent,e.abrupt("return",r.success);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t["a"]=new o},6525:function(e,t,r){"use strict";r("96cf");var a=r("1da1"),n=r("d4ec"),s=r("bee2"),c=r("27de"),o=function(){function e(){Object(n["a"])(this,e)}return Object(s["a"])(e,[{key:"getItem",value:function(e){return window.localStorage.getItem(e)}},{key:"putItem",value:function(e,t){window.localStorage.setItem(e,t)}},{key:"remove",value:function(e){window.localStorage.removeItem(e)}}]),e}(),u=new o,i=function(){function e(){Object(n["a"])(this,e)}return Object(s["a"])(e,[{key:"isLogin",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=u.getItem("token"),t){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,c["a"].getConsumerInfo();case 5:return r=e.sent,e.abrupt("return",r.success);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getConsumerInfo",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.consumerInfo){e.next=2;break}return e.abrupt("return",this.consumerInfo);case 2:return e.next=4,c["a"].getConsumerInfo();case 4:if(t=e.sent,t.success){e.next=7;break}throw new Error("获取用户信息失败:"+t.msg);case 7:return e.abrupt("return",t.data);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"login",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].login(t,r);case 2:if(a=e.sent,a.success){e.next=5;break}throw new Error("登录失败:"+a.msg);case 5:return u.putItem("token",a.data.token),e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"register",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].register(t);case 2:if(r=e.sent,r.success){e.next=5;break}throw new Error("注册失败:"+r.msg);case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getDefaultDelivery",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].getConsumerDefaultDelivery();case 2:if(t=e.sent,t.success){e.next=5;break}throw new Error("获取默认收货信息失败:"+t.msg);case 5:return e.abrupt("return",t.data);case 6:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){u.remove("token")}},{key:"uploadAvatar",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t&&0!==t.length){e.next=2;break}throw new Error("上传头像失败:没有选择图片");case 2:return r=new FormData,r.append("file",t[0]),e.next=6,c["a"].uploadAvatar(r);case 6:if(a=e.sent,a.success){e.next=9;break}throw new Error("上传头像失败:"+a.msg);case 9:return e.abrupt("return",a.data);case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateUserInfo",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].updateUserInfo(t);case 2:if(r=e.sent,r.success){e.next=5;break}throw new Error("保存用户信息失败:"+r.msg);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updatePassword",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].updatePassword(t,r);case 2:if(a=e.sent,a.success){e.next=5;break}throw new Error("修改密码失败:"+a.msg);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();t["a"]=new i},7716:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[e._v(" "+e._s(e.shopInfo.shopName)+" "),r("span",{staticClass:"el-icon-arrow-right"})]),r("ul",{staticClass:"order-detail-list"},[e._l(e.productList,(function(t){return r("li",{key:t.productId+"-"+t.specId,staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-avatar",{attrs:{shape:"square",src:t.productImg}})],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[e._v("￥"+e._s(t.productPrice))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[e._v("X "+e._s(t.productQuantity))]),r("h4",[e._v(e._s(t.productName))]),r("span",{staticClass:"spec-name"},[e._v(e._s(t.specName))])])],1)],1)})),r("el-divider"),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",effect:"dark"}},[r("span",{staticClass:"el-icon-truck"}),e._v(" 配送费")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[e._v("￥"+e._s(e.shopInfo.deliveryFee))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[e._v("X 1")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium"}},[r("span",{staticClass:"el-icon-tableware"}),e._v(" 包装费")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[e._v("￥"+e._s(e.getTotalPackageFee()))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[e._v("X 1")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",type:"danger"}},[r("span",{staticClass:"el-icon-s-goods"}),e._v(" 红包折扣")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticClass:"el-icon"}),r("span",{staticStyle:{float:"right"}},[e._v("-￥20")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",type:"warning"}},[r("span",{staticClass:"el-icon-money"}),e._v(" 实付")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[e._v("￥"+e._s(e.getTotalAmount()))])])],1)],1)],2)])],1)},n=[],s=r("e9c0"),c={props:["shopInfo","productList"],data:function(){return{}},methods:{getTotalPackageFee:function(){return s["a"].calcTotalPackageFee(this.productList)},getTotalAmount:function(){return s["a"].calcTotalAmount(this.productList)}}},o=c,u=(r("fb4a"),r("2877")),i=Object(u["a"])(o,a,n,!1,null,"15ce92b2",null);t["a"]=i.exports},8431:function(e,t,r){},8873:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticStyle:{"margin-bottom":"20px"}},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),r("el-breadcrumb-item",{attrs:{to:{path:"/shop/1"}}},[e._v(e._s(e.shopInfo.shopName))]),r("el-breadcrumb-item",[e._v("确认下单")])],1)],1),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:16}},[r("order-product",{attrs:{shopInfo:e.shopInfo,productList:e.productList}})],1),r("el-col",{attrs:{span:8}},[r("el-card",[r("el-row",[r("el-col",{attrs:{span:4}},[r("span",{staticClass:"el-icon-location location-icon"})]),r("el-col",{attrs:{span:18}},[r("strong",[e._v(e._s(e.delivery.realName))]),e._v(" "),r("span",{staticStyle:{"font-size":"14px"}},[e._v("先生/女士")]),e._v(" "),r("span",{staticClass:"phone"},[e._v(e._s(e.delivery.phone))]),r("p",{staticClass:"address"},[e._v(e._s(e.delivery.building)+" "+e._s(e.delivery.detail))])]),r("el-col",{attrs:{span:2}},[r("span",{staticClass:"el-icon-arrow-right"})])],1)],1),r("el-card",{staticClass:"delivery-time"},[r("el-col",{attrs:{span:8}},[r("h1",[e._v("送达时间")])]),r("el-col",{attrs:{span:16}},[r("p",[e._v("预计 "+e._s(e.getDeliveryTime()))]),r("el-tag",{attrs:{effect:"dark",type:"primary",size:"mini"}},[e._v("蜂鸟专送")])],1)],1),r("el-card",{staticClass:"coupon-list"},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("红包卡券")]),r("ul",e._l(e.couponList,(function(t){return r("li",{key:t},[r("el-row",[r("el-col",{attrs:{span:4}},[r("span",{staticClass:"el-icon-s-cooperation"})]),r("el-col",{attrs:{span:18}},[r("p",[e._v(e._s(t))])]),r("el-col",{attrs:{span:2}},[r("span",{staticClass:"el-icon-arrow-right"})])],1)],1)})),0)]),r("el-card",{staticStyle:{"margin-top":"10px"}},[r("ul",[r("li",[r("span",[e._v("支付方式")]),r("el-select",{staticStyle:{width:"100px","margin-left":"100px"},attrs:{placeholder:"请选择"},model:{value:e.payValue,callback:function(t){e.payValue=t},expression:"payValue"}},e._l(e.payOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-divider"),r("li",[r("p",[e._v("订单备注")]),r("el-input",{attrs:{type:"textarea"},model:{value:e.orderForm.orderNote,callback:function(t){e.$set(e.orderForm,"orderNote",t)},expression:"orderForm.orderNote"}})],1)],1)]),r("el-card",{staticStyle:{"margin-top":"10px"}},[r("span",[e._v("待支付:￥ "+e._s(e.totalAmount))]),r("el-button",{staticStyle:{"margin-left":"50px"},attrs:{type:"success"},on:{click:e.handleMakeOrder}},[e._v("确认下单")])],1)],1)],1)],1)},n=[],s=(r("96cf"),r("1da1")),c=r("7716"),o=r("6525"),u=r("2d01"),i=r("3b6a"),l=r("e9c0"),p={data:function(){return{payValue:"支付宝",payOptions:["支付宝","银联"],shopInfo:{},productList:[],hasDefaultDelivery:!1,delivery:{},orderForm:{deliveryId:"",orderNote:"",productList:[]},couponList:["店铺红包 | 满 20-20","超值联盟红包 | 满 20-3","新人首单红包 | 满 20-15"]}},components:{OrderProduct:c["a"]},created:function(){this.shopInfo=this.$store.state.confirmOrderData.shopInfo,this.productList=this.$store.state.confirmOrderData.productList,this.orderForm.productList=this.productList,this.getDefaultDelivery()},computed:{totalAmount:function(){return l["a"].calcTotalAmount(this.productList)}},methods:{getDefaultDelivery:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o["a"].getDefaultDelivery();case 3:r=t.sent,r&&(e.hasDefaultDelivery=!0,e.delivery=r,e.orderForm.deliveryId=e.delivery.deliveryId),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$message.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getDeliveryTime:function(){return u["a"].getOrderDeliveryTime()},handleMakeOrder:function(){this.makeOrder()},makeOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].makeOrder(e.orderForm);case 3:r=t.sent,r&&(e.$message.success("下单成功,请进行支付"),i["a"].clearCart(e.shopInfo.shopId),e.$router.push({name:"pay",params:{orderId:r,shopInfo:e.shopInfo}})),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$message.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}}},d=p,f=(r("d859"),r("2877")),v=Object(f["a"])(d,a,n,!1,null,"fe91f0a6",null);t["default"]=v.exports},d81d:function(e,t,r){"use strict";var a=r("23e7"),n=r("b727").map,s=r("1dde"),c=r("ae40"),o=s("map"),u=c("map");a({target:"Array",proto:!0,forced:!o||!u},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},d859:function(e,t,r){"use strict";r("fbf4")},e9c0:function(e,t,r){"use strict";r("4160"),r("159b");var a=r("d4ec"),n=r("bee2"),s=function(){function e(){Object(a["a"])(this,e)}return Object(n["a"])(e,[{key:"getProductPriceRange",value:function(e){var t=e.productSpecList[0].price,r=e.productSpecList[0].price;return e.productSpecList.forEach((function(e){e.price<r&&(r=e.price),e.price>t&&(t=e.price)})),{highPrice:t,lowPrice:r}}},{key:"calcTotalPackageFee",value:function(e){if(!e)return 0;var t=0;return e.forEach((function(e){t+=e.packageFee})),t}},{key:"calcTotalAmount",value:function(e){if(!e)return 0;var t=0;return e.forEach((function(e){t+=e.productPrice*e.productQuantity})),t+=this.calcTotalPackageFee(e),t}},{key:"calcProductTotalAmount",value:function(e){return this.calcTotalAmount(e)-this.calcTotalPackageFee(e)}}]),e}();t["a"]=new s},fb4a:function(e,t,r){"use strict";r("8431")},fbf4:function(e,t,r){}}]);
//# sourceMappingURL=chunk-7bad441b.e79b3c38.js.map