(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2880524"],{"0578":function(t,e,r){},"083c":function(t,e,r){"use strict";r("cf32")},2126:function(t,e,r){},"2d01":function(t,e,r){"use strict";r("4160"),r("d81d"),r("159b"),r("96cf");var a=r("1da1"),s=r("d4ec"),i=r("bee2"),o=r("c1df"),n=r.n(o),c=r("27de");n.a.locale("zh-cn");var l=function(){function t(){Object(s["a"])(this,t)}return Object(i["a"])(t,[{key:"getOrderDeliveryTime",value:function(){return n()().add(1,"hours").calendar()}},{key:"makeOrder",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=JSON.parse(JSON.stringify(e)),e.deliveryId){t.next=3;break}throw new Error("下单失败:收货信息ID为空");case 3:if(e.productList){t.next=5;break}throw new Error("下单失败:下单商品列表为空");case 5:return e.productList=e.productList.map((function(t){return{productId:t.productId,specId:t.specId,quantity:t.productQuantity}})),t.next=8,c["a"].makeOrder(e);case 8:if(r=t.sent,r.success){t.next=11;break}throw new Error("下单失败:"+r.msg);case 11:return t.abrupt("return",r.data);case 12:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getOrderList",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].getOrderList(e,r);case 2:if(a=t.sent,a.success){t.next=5;break}throw new Error("获取订单列表失败:"+a.msg);case 5:return t.abrupt("return",a.data);case 6:case"end":return t.stop()}}),t)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"getOrderDetail",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].getOrderDetail(e);case 2:if(r=t.sent,r.success){t.next=5;break}throw new Error("获取订单详情失败:"+r.msg);case 5:return r.data&&r.data.productList&&r.data.productList.forEach((function(t){t.specId=t.productSpec})),t.abrupt("return",r.data);case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getOrderStatus",value:function(t){return 0===t.orderStatus?"未处理":1===t.orderStatus?"已处理":2===t.orderStatus?"配送中":3===t.orderStatus?"已完结":4===t.orderStatus?"已作废":void 0}}]),t}();e["a"]=new l},"4fdb":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-card",{staticClass:"order-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("div",{staticClass:"shop-img",on:{click:function(e){return t.$router.push("/shop/1")}}},[r("el-avatar",{attrs:{src:t.order.shopLogo,fit:"cover",shape:"square",size:64}})],1)]),r("el-col",{attrs:{span:22}},[r("span",{staticClass:"order-status"},[t._v(t._s(t.getOrderStatus(t.order)))]),r("h4",{staticClass:"shop-name",on:{click:function(e){return t.$router.push("/shop/"+t.order.shopId)}}},[t._v(t._s(t.order.shopName)+" "),r("span",{staticClass:"el-icon-arrow-right"})]),r("p",{staticClass:"order-date"},[t._v(t._s(t.order.createTime))]),r("el-divider"),r("el-row",[r("el-col",{staticClass:"order-detail",attrs:{span:18}},[r("ul",{staticClass:"order-img-list"},t._l(t.order.imgList,(function(e){return r("li",{key:e+Math.random(),staticClass:"order-img-item"},[r("el-image",{attrs:{fit:"cover",src:e,"preview-src-list":t.order.imgList}})],1)})),0)]),r("el-col",{attrs:{span:6}},[r("p",{staticClass:"order-price"},[t._v("￥"+t._s(t.order.orderAmount))]),r("p",{staticClass:"order-name"},[t._v(t._s(t.order.orderName))])])],1),"配送中"===t.getOrderStatus(t.order)&&t.editable?r("div",{staticClass:"amap-box-wrapper"},[r("el-amap",{staticClass:"amap-box",attrs:{zoom:20,center:[118.636466,24.8736]}},[r("el-amap-marker",{attrs:{vid:"component-shop-marker",position:[118.637466,24.8734]}}),r("el-amap-text",{attrs:{vid:"component-shop-text",position:[118.637466,24.8734],text:"店铺"}}),r("el-amap-marker",{attrs:{vid:"component-rider-marker",position:[118.637066,24.8737]}}),r("el-amap-text",{attrs:{vid:"component-rider-text",position:[118.637066,24.8737],text:"骑手"}})],1)],1):t._e(),"已完结"===t.getOrderStatus(t.order)&&t.editable?r("el-button",{staticStyle:{float:"right","margin-top":"5px","margin-left":"15px"},attrs:{size:"mini",type:"warning"},on:{click:t.showOrderEval}},[t._v("评价订单")]):t._e(),t.editable?r("el-button",{staticStyle:{float:"right","margin-top":"5px","margin-left":"15px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.$router.push("/shop/"+t.order.shopId)}}},[t._v("再来一单")]):t._e(),t.editable?r("el-button",{staticStyle:{float:"right","margin-top":"5px"},attrs:{size:"mini",type:"success"},on:{click:function(e){return t.showOrderDetail(t.order.orderId)}}},[t._v("订单详情")]):t._e()],1)],1),t.editable?r("order-eval"):t._e()],1)},s=[],i=r("2d01"),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"订单评价",visible:t.$store.state.evalPaneShow,width:"30%"},on:{close:function(e){return t.$store.commit("closeEvalPaneShow")}}},[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-avatar",{attrs:{src:"/imgs/foods/huangmenji.jpg",fit:"cover",shape:"square",size:48}})],1),r("el-col",{attrs:{span:16}},[r("h4",{staticClass:"shop-name"},[t._v("黄焖鸡米饭 "),r("span",{staticClass:"el-icon-arrow-right"})])]),r("el-col",{attrs:{span:4}},[r("div",{staticClass:"annoymous-wrapper"},[r("el-checkbox",{attrs:{label:"匿名评价"}})],1)])],1),r("div",{staticClass:"shop-rate-wrapper"},[r("div",{staticClass:"shop-main-rate"},[r("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"show-text":"","allow-half":""},model:{value:t.mainRate,callback:function(e){t.mainRate=e},expression:"mainRate"}})],1),t.showSubRate?r("div",{staticClass:"shop-package-rate"},[r("span",[t._v("包装 ")]),r("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"show-text":"","allow-half":""},model:{value:t.packageRate,callback:function(e){t.packageRate=e},expression:"packageRate"}})],1):t._e(),t.showSubRate?r("div",{staticClass:"shop-package-rate"},[r("span",[t._v("味道 ")]),r("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"show-text":"","allow-half":""},model:{value:t.tasteRate,callback:function(e){t.tasteRate=e},expression:"tasteRate"}})],1):t._e()]),r("div",{staticStyle:{"margin-top":"20px"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"满意你就夸一夸"},model:{value:t.evalContent,callback:function(e){t.evalContent=e},expression:"evalContent"}}),r("el-upload",{staticClass:"upload",attrs:{action:"/upload","auto-upload":!1,"file-list":t.fileList,"list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[t._v("添加照片")])],1)],1),r("el-divider"),r("el-row",[r("el-col",{attrs:{span:4}},[r("el-avatar",{attrs:{src:"/imgs/rider.jpg",fit:"cover",shape:"square",size:48}})],1),r("el-col",{attrs:{span:14}},[r("h4",{staticClass:"shop-name"},[t._v("杨超锋 "),r("span",{staticClass:"fengniao-delivery"},[t._v("蜂鸟专送")])])]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"annoymous-wrapper"},[r("span",{staticClass:"el-icon-question"},[t._v(" 已对骑手匿名")])])])],1),r("ul",{staticClass:"rider-eval-list"},[r("li",{staticClass:"rider-eval-item"},[r("span",{staticClass:"el-icon-heavy-rain rider-eval-icon",class:{active:"bad"===t.riderRate},on:{click:function(e){t.riderRate="bad"}}}),r("p",[t._v("非常差")])]),r("li",{staticClass:"rider-eval-item"},[r("span",{staticClass:"el-icon-sunrise rider-eval-icon",class:{active:"normal"===t.riderRate},on:{click:function(e){t.riderRate="normal"}}}),r("p",[t._v("一般")])]),r("li",{staticClass:"rider-eval-item"},[r("span",{staticClass:"el-icon-sunny rider-eval-icon",class:{active:"good"===t.riderRate},on:{click:function(e){t.riderRate="good"}}}),r("p",[t._v("超赞")])])]),r("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.submitEval}},[t._v("提交评价")])],1)},n=[],c={data:function(){return{mainRate:0,packageRate:0,tasteRate:0,evalContent:"",fileList:[],riderRate:""}},methods:{beforeUpload:function(){return!1},submitEval:function(){this.$notify({title:"成功",message:"提交评价成功",type:"success"}),this.$store.commit("closeEvalPaneShow")}},computed:{showSubRate:function(){return 0!==this.mainRate}}},l=c,u=(r("b00a"),r("2877")),d=Object(u["a"])(l,o,n,!1,null,"58f9c856",null),p=d.exports,m={props:{order:{type:Object,required:!0},editable:{type:Boolean,required:!1,default:!0}},data:function(){return{}},methods:{getOrderStatus:function(t){return i["a"].getOrderStatus(t)},showOrderDetail:function(t){this.$emit("show-order-detail",t)},showOrderEval:function(t){this.$store.commit("toogleEvalPaneShow")}},components:{OrderEval:p}},h=m,v=(r("dc81"),Object(u["a"])(h,a,s,!1,null,"29e9547f",null));e["a"]=v.exports},7716:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.shopInfo.shopName)+" "),r("span",{staticClass:"el-icon-arrow-right"})]),r("ul",{staticClass:"order-detail-list"},[t._l(t.productList,(function(e){return r("li",{key:e.productId+"-"+e.specId,staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-avatar",{attrs:{shape:"square",src:e.productImg}})],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[t._v("￥"+t._s(e.productPrice))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[t._v("X "+t._s(e.productQuantity))]),r("h4",[t._v(t._s(e.productName))]),r("span",{staticClass:"spec-name"},[t._v(t._s(e.specName))])])],1)],1)})),r("el-divider"),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",effect:"dark"}},[r("span",{staticClass:"el-icon-truck"}),t._v(" 配送费")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[t._v("￥"+t._s(t.shopInfo.deliveryFee))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[t._v("X 1")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium"}},[r("span",{staticClass:"el-icon-tableware"}),t._v(" 包装费")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[t._v("￥"+t._s(t.getTotalPackageFee()))]),r("span",{staticStyle:{float:"right",color:"#666","margin-right":"20px"}},[t._v("X 1")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",type:"danger"}},[r("span",{staticClass:"el-icon-s-goods"}),t._v(" 红包折扣")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticClass:"el-icon"}),r("span",{staticStyle:{float:"right"}},[t._v("-￥20")])])],1)],1),r("li",{staticClass:"order-detail-item"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-tag",{attrs:{size:"medium",type:"warning"}},[r("span",{staticClass:"el-icon-money"}),t._v(" 实付")])],1),r("el-col",{attrs:{span:22}},[r("span",{staticStyle:{float:"right"}},[t._v("￥"+t._s(t.getTotalAmount()))])])],1)],1)],2)])],1)},s=[],i=r("e9c0"),o={props:["shopInfo","productList"],data:function(){return{}},methods:{getTotalPackageFee:function(){return i["a"].calcTotalPackageFee(this.productList)},getTotalAmount:function(){return i["a"].calcTotalAmount(this.productList)}}},n=o,c=(r("fb4a"),r("2877")),l=Object(c["a"])(n,a,s,!1,null,"15ce92b2",null);e["a"]=l.exports},8431:function(t,e,r){},b00a:function(t,e,r){"use strict";r("2126")},cf2a:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("order-list",{attrs:{orderList:t.orderList},on:{"show-order-detail":t.handleShowOrderDetail}}),r("el-card",{staticStyle:{"text-align":"center"}},[r("el-pagination",{attrs:{background:"","current-page":t.page,"page-sizes":[5,10,20,30],"page-size":t.size,layout:"prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handlePageChange}})],1),r("order-detail",{attrs:{show:t.orderDetailShow,order:t.orderDetail},on:{close:t.handleDetailClose}})],1)},s=[],i=(r("96cf"),r("1da1")),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticStyle:{"margin-bottom":"20px"}},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),r("el-breadcrumb-item",[t._v("订单列表")])],1)],1),r("ul",{staticClass:"order-list"},t._l(t.orderList,(function(e){return r("li",{key:e.orderId},[r("order-item",{attrs:{order:e},on:{"show-order-detail":function(r){return t.$emit("show-order-detail",e.orderId)}}})],1)})),0)])},n=[],c=r("4fdb"),l={props:["orderList"],data:function(){return{}},methods:{},components:{OrderItem:c["a"]}},u=l,d=r("2877"),p=Object(d["a"])(u,o,n,!1,null,"d274ae0e",null),m=p.exports,h=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"订单详情",visible:t.$store.state.orderDetailShow,width:"80%"},on:{close:function(e){return t.$store.commit("toggleOrderDetail")}}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:20}},[r("order-product",{attrs:{productList:t.order.productList,shopInfo:{shopName:t.order.shopName,deliveryFee:t.order.deliveryFee}}})],1),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"order-detail-header"},[r("el-avatar",{attrs:{size:80,src:t.order.shopLogo}}),r("h2",[t._v(t._s(t.getPayStatus(t.order.payStatus)))]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$router.push("shop")}}},[t._v("再来一单")])],1)],1)],1),r("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v("配送信息")]),r("ul",{staticClass:"delivery-info"},[r("li",[t._v("送达时间：尽快送达")]),r("li",[t._v("送货地址："+t._s(t.order.consumerAddress))]),r("li",[t._v("收货人："+t._s(t.order.consumerName))]),r("li",[t._v("手机："+t._s(t.order.consumerPhone))]),r("li",[t._v("备注："+t._s(t.order.orderNote))])]),r("el-divider"),r("el-timeline",[r("el-timeline-item",{key:1,attrs:{type:"success",timestamp:"2020-04-03 20:46"}},[t._v("顾客下单")]),r("el-timeline-item",{key:2,attrs:{type:"success",timestamp:"2020-04-03 21:46"}},[t._v("商家制作")]),r("el-timeline-item",{key:3,attrs:{type:"primary",timestamp:"2020-04-03 22:46"}},[t._v("骑手配送")]),r("el-timeline-item",{key:4,attrs:{type:"info",timestamp:"2020-04-03 23:46"}},[t._v("订单完结")])],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-card",{staticClass:"order-info"},[r("div",{attrs:{slot:"header"},slot:"header"},[t._v("订单信息")]),r("ul",[r("li",[t._v("订单号: "+t._s(t.order.orderId))]),r("li",[t._v("创建时间："+t._s(t.order.createTime))])])]),r("el-card",{staticStyle:{"margin-top":"10px"}},[r("div",{attrs:{slot:"header"},slot:"header"},[t._v("地图")]),r("el-amap",{staticClass:"amap-box",attrs:{vid:"amap-vue",zoom:10,center:[117.5,24]}},[r("el-amap-marker",{attrs:{vid:"component-shop-marker",position:[117.5,24]}}),r("el-amap-text",{attrs:{vid:"component-shop-text",position:[117.5,24],text:"店铺位置"}}),r("el-amap-marker",{attrs:{vid:"component-rider-marker",position:[117.5,24.1]}}),r("el-amap-text",{attrs:{vid:"component-rider-text",position:[117.5,24.1],text:"骑手位置"}})],1)],1)],1)],1)],1)},v=[],f=r("7716"),g=r("e72b"),w={props:["show","order"],data:function(){return{}},components:{OrderProduct:f["a"]},methods:{getPayStatus:function(t){return g["a"].getPayStatusStr(t)}},created:function(){}},_=w,b=(r("083c"),Object(d["a"])(_,h,v,!1,null,"50750720",null)),y=b.exports,k=r("2d01"),x={data:function(){return{orderDetailShow:!0,page:1,size:10,total:0,orderList:[],orderDetail:{}}},components:{OrderList:m,OrderDetail:y},methods:{handleDetailClose:function(){this.orderDetailShow=!1},getOrderList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k["a"].getOrderList(t.page,t.size);case 3:r=e.sent,t.orderList=r.data,t.total=r.total,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$message.error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},handleSizeChange:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.size=t,r.next=3,e.getOrderList();case 3:e.scrollToTop();case 4:case"end":return r.stop()}}),r)})))()},scrollToTop:function(){window.scrollTo({top:0})},handlePageChange:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.page=t,r.next=3,e.getOrderList();case 3:e.scrollToTop();case 4:case"end":return r.stop()}}),r)})))()},handleShowOrderDetail:function(t){this.getOrderDetail(t),this.$store.commit("toggleOrderDetail")},getOrderDetail:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,k["a"].getOrderDetail(t);case 3:e.orderDetail=r.sent,r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),e.$message.error(r.t0.message);case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()}},created:function(){this.getOrderList()}},C=x,O=Object(d["a"])(C,a,s,!1,null,"3013736e",null);e["default"]=O.exports},cf32:function(t,e,r){},d81d:function(t,e,r){"use strict";var a=r("23e7"),s=r("b727").map,i=r("1dde"),o=r("ae40"),n=i("map"),c=o("map");a({target:"Array",proto:!0,forced:!n||!c},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},dc81:function(t,e,r){"use strict";r("0578")},e9c0:function(t,e,r){"use strict";r("4160"),r("159b");var a=r("d4ec"),s=r("bee2"),i=function(){function t(){Object(a["a"])(this,t)}return Object(s["a"])(t,[{key:"getProductPriceRange",value:function(t){var e=t.productSpecList[0].price,r=t.productSpecList[0].price;return t.productSpecList.forEach((function(t){t.price<r&&(r=t.price),t.price>e&&(e=t.price)})),{highPrice:e,lowPrice:r}}},{key:"calcTotalPackageFee",value:function(t){if(!t)return 0;var e=0;return t.forEach((function(t){e+=t.packageFee})),e}},{key:"calcTotalAmount",value:function(t){if(!t)return 0;var e=0;return t.forEach((function(t){e+=t.productPrice*t.productQuantity})),e+=this.calcTotalPackageFee(t),e}},{key:"calcProductTotalAmount",value:function(t){return this.calcTotalAmount(t)-this.calcTotalPackageFee(t)}}]),t}();e["a"]=new i},fb4a:function(t,e,r){"use strict";r("8431")}}]);
//# sourceMappingURL=chunk-e2880524.c328cea5.js.map