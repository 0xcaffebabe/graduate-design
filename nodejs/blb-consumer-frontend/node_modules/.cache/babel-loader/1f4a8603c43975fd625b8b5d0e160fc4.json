{"remainingRequest":"D:\\project\\blb-consumer-frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\blb-consumer-frontend\\src\\components\\shop\\ShopEval.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\blb-consumer-frontend\\src\\components\\shop\\ShopEval.vue","mtime":1613365578288},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovcHJvamVjdC9ibGItY29uc3VtZXItZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgc2hvcFNlcnZpY2UgZnJvbSAnLi4vLi4vc2VydmljZS9TaG9wU2VydmljZSc7CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiBbJ3Nob3BJZCddLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG9wRXZhbDoge30sCiAgICAgIGV2YWxMaXN0OiBbXSwKICAgICAgY3VycmVudEV2YWw6IC0xLAogICAgICBldmFsUGFnZTogMSwKICAgICAgZXZhbFBhZ2VTaXplOiAxMCwKICAgICAgZXZhbFRvdGFsOiAwCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGFsbEV2YWxTdW06IGZ1bmN0aW9uIGFsbEV2YWxTdW0oKSB7CiAgICAgIGlmICghdGhpcy5zaG9wRXZhbC53b3JkQ2xvdWQpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQoKICAgICAgdmFyIHN1bSA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2hvcEV2YWwud29yZENsb3VkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgc3VtICs9IHRoaXMuc2hvcEV2YWwud29yZENsb3VkW2ldLmNvdW50OwogICAgICB9CgogICAgICByZXR1cm4gc3VtOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0U2hvcEV2YWw6IGZ1bmN0aW9uIGdldFNob3BFdmFsKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgc2hvcEV2YWw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBzaG9wU2VydmljZS5nZXRTaG9wRXZhbChfdGhpcy5zaG9wSWQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBzaG9wRXZhbCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfdGhpcy5zaG9wRXZhbCA9IHNob3BFdmFsOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcihfY29udGV4dC50MC5tZXNzYWdlKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgN11dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZ2V0U2hvcEV2YWxMaXN0OiBmdW5jdGlvbiBnZXRTaG9wRXZhbExpc3QoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBzaG9wU2VydmljZS5nZXRTaG9wRXZhbExpc3QoewogICAgICAgICAgICAgICAgICBzaG9wSWQ6IF90aGlzMi5zaG9wSWQsCiAgICAgICAgICAgICAgICAgIHRhZ0lkOiBfdGhpczIuY3VycmVudEV2YWwsCiAgICAgICAgICAgICAgICAgIHBhZ2U6IF90aGlzMi5ldmFsUGFnZSwKICAgICAgICAgICAgICAgICAgc2l6ZTogX3RoaXMyLmV2YWxQYWdlU2l6ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzMi5ldmFsTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIF90aGlzMi5ldmFsVG90YWwgPSBkYXRhLnRvdGFsOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDg7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKF9jb250ZXh0Mi50MC5tZXNzYWdlKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1swLCA4XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjYWxjRGF0ZTogZnVuY3Rpb24gY2FsY0RhdGUoZGF0ZSkgewogICAgICByZXR1cm4gbW9tZW50KGRhdGUsICdZWVlZTU1ERCcpLmZyb21Ob3coKTsKICAgIH0sCiAgICBoYW5kbGVQYWdlQ2hhbmdlZDogZnVuY3Rpb24gaGFuZGxlUGFnZUNoYW5nZWQodmFsKSB7CiAgICAgIHRoaXMuZXZhbFBhZ2UgPSB2YWw7CiAgICAgIHRoaXMuZ2V0U2hvcEV2YWxMaXN0KCk7CiAgICB9LAogICAgaGFuZGxlU2l6ZUNoYW5nZWQ6IGZ1bmN0aW9uIGhhbmRsZVNpemVDaGFuZ2VkKHZhbCkgewogICAgICB0aGlzLmV2YWxQYWdlU2l6ZSA9IHZhbDsKICAgICAgdGhpcy5nZXRTaG9wRXZhbExpc3QoKTsKICAgIH0sCiAgICBoYW5kbGVUYWdDbGljazogZnVuY3Rpb24gaGFuZGxlVGFnQ2xpY2sodGFnSWQpIHsKICAgICAgdGhpcy5jdXJyZW50RXZhbCA9IHRhZ0lkOwogICAgICB0aGlzLmdldFNob3BFdmFsTGlzdCgpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0U2hvcEV2YWwoKTsKICAgIHRoaXMuZ2V0U2hvcEV2YWxMaXN0KCk7CiAgfQp9Ow=="},{"version":3,"sources":["ShopEval.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA,OAAA,WAAA,MAAA,2BAAA;AACA,OAAA,MAAA,MAAA,QAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA,CAAA,QAAA,CADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA,EAFA;AAGA,MAAA,WAAA,EAAA,CAAA,CAHA;AAIA,MAAA,QAAA,EAAA,CAJA;AAKA,MAAA,YAAA,EAAA,EALA;AAMA,MAAA,SAAA,EAAA;AANA,KAAA;AAQA,GAXA;AAYA,EAAA,QAAA,EAAA;AACA,IAAA,UADA,wBACA;AACA,UAAA,CAAA,KAAA,QAAA,CAAA,SAAA,EAAA;AACA,eAAA,CAAA;AACA;;AACA,UAAA,GAAA,GAAA,CAAA;;AACA,WAAA,IAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,KAAA,QAAA,CAAA,SAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,QAAA,GAAA,IAAA,KAAA,QAAA,CAAA,SAAA,CAAA,CAAA,EAAA,KAAA;AACA;;AACA,aAAA,GAAA;AACA;AAVA,GAZA;AAwBA,EAAA,OAAA,EAAA;AACA,IAAA,WADA,yBACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEA,WAAA,CAAA,WAAA,CAAA,KAAA,CAAA,MAAA,CAFA;;AAAA;AAEA,gBAAA,QAFA;AAGA,gBAAA,KAAA,CAAA,QAAA,GAAA,QAAA;AAHA;AAAA;;AAAA;AAAA;AAAA;;AAKA,gBAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,YAAA,OAAA;;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,KARA;AASA,IAAA,eATA,6BASA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEA,WAAA,CAAA,eAAA,CAAA;AACA,kBAAA,MAAA,EAAA,MAAA,CAAA,MADA;AAEA,kBAAA,KAAA,EAAA,MAAA,CAAA,WAFA;AAGA,kBAAA,IAAA,EAAA,MAAA,CAAA,QAHA;AAIA,kBAAA,IAAA,EAAA,MAAA,CAAA;AAJA,iBAAA,CAFA;;AAAA;AAEA,gBAAA,IAFA;AAQA,gBAAA,MAAA,CAAA,QAAA,GAAA,IAAA,CAAA,IAAA;AACA,gBAAA,MAAA,CAAA,SAAA,GAAA,IAAA,CAAA,KAAA;AATA;AAAA;;AAAA;AAAA;AAAA;;AAWA,gBAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,aAAA,OAAA;;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA,KAtBA;AAuBA,IAAA,QAvBA,oBAuBA,IAvBA,EAuBA;AACA,aAAA,MAAA,CAAA,IAAA,EAAA,UAAA,CAAA,CAAA,OAAA,EAAA;AACA,KAzBA;AA0BA,IAAA,iBA1BA,6BA0BA,GA1BA,EA0BA;AACA,WAAA,QAAA,GAAA,GAAA;AACA,WAAA,eAAA;AACA,KA7BA;AA8BA,IAAA,iBA9BA,6BA8BA,GA9BA,EA8BA;AACA,WAAA,YAAA,GAAA,GAAA;AACA,WAAA,eAAA;AACA,KAjCA;AAkCA,IAAA,cAlCA,0BAkCA,KAlCA,EAkCA;AACA,WAAA,WAAA,GAAA,KAAA;AACA,WAAA,eAAA;AACA;AArCA,GAxBA;AA+DA,EAAA,OA/DA,qBA+DA;AACA,SAAA,WAAA;AACA,SAAA,eAAA;AACA;AAlEA,CAAA","sourcesContent":["<template>\r\n  <el-row :gutter='20'>\r\n    <el-col :span='18'>\r\n        <el-tag class=\"eval-tag\" type='primary' :effect='currentEval == -1 ?\"dark\":\"light\"' @click=\"handleTagClick(-1)\">全部评价({{allEvalSum}})</el-tag>\r\n        <el-tag class=\"eval-tag\"\r\n        v-for='item in shopEval.wordCloud'\r\n        :key='item.id'\r\n        :type=\"!item.positive?'info':'primary'\"\r\n        :effect=\"currentEval === item.id?'dark':'light'\"\r\n        @click=\"handleTagClick(item.id)\"\r\n        >{{item.content}}({{item.count}})</el-tag>\r\n        <el-divider></el-divider>\r\n        <ul class=\"eval-list\">\r\n          <li v-for=\"item in evalList\" :key=\"item.evalId\" class=\"eval-list-item\">\r\n            <el-row>\r\n              <el-col :span=\"2\">\r\n                <el-avatar>{{item.nickName}}</el-avatar>\r\n              </el-col>\r\n              <el-col :span=\"22\">\r\n                <span class=\"eval-date\">{{calcDate(item.createTime)}}</span>\r\n                <h3>{{item.phone}}</h3>\r\n                <el-rate :value=\"parseFloat(item.ranking)\" disabled></el-rate>\r\n                <p>{{item.content}}</p>\r\n                <ul class=\"img-list\">\r\n                  <li v-for=\"img in item.imgList\" :key=\"img + Math.random()\">\r\n                    <el-image\r\n                    :src=\"img\"\r\n                    :preview-src-list=\"item.imgList\"\r\n                    fit=\"cover\"\r\n                    />\r\n                  </li>\r\n                </ul>\r\n              </el-col>\r\n            </el-row>\r\n            <el-divider></el-divider>\r\n          </li>\r\n        </ul>\r\n        <el-pagination\r\n          style=\"text-align:center\"\r\n          @size-change=\"handleSizeChanged\"\r\n          background\r\n          @current-change=\"handlePageChanged\"\r\n          :current-page=\"evalPage\"\r\n          :page-sizes=\"[2, 10, 20, 30]\"\r\n          :page-size=\"evalPageSize\"\r\n          layout=\"prev, pager, next\"\r\n          :total=\"evalTotal\">\r\n        </el-pagination>\r\n    </el-col>\r\n    <el-col :span='6'>\r\n      <el-card class='eval-info'>\r\n        <h2>{{shopEval.rating}}</h2>\r\n        <p class='eval-avg'>综合评价</p>\r\n        <p class='rating'>高于周围{{shopEval.wingRate}}%的商家</p>\r\n      </el-card>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport shopService from '../../service/ShopService'\r\nimport moment from 'moment'\r\nexport default {\r\n  props: ['shopId'],\r\n  data () {\r\n    return {\r\n      shopEval: {},\r\n      evalList: [],\r\n      currentEval: -1,\r\n      evalPage: 1,\r\n      evalPageSize: 10,\r\n      evalTotal: 0\r\n    }\r\n  },\r\n  computed: {\r\n    allEvalSum () {\r\n      if (!this.shopEval.wordCloud) {\r\n        return 0\r\n      }\r\n      let sum = 0\r\n      for (let i = 0; i < this.shopEval.wordCloud.length; i++) {\r\n        sum += this.shopEval.wordCloud[i].count\r\n      }\r\n      return sum\r\n    }\r\n  },\r\n  methods: {\r\n    async getShopEval () {\r\n      try {\r\n        const shopEval = await shopService.getShopEval(this.shopId)\r\n        this.shopEval = shopEval\r\n      } catch (e) {\r\n        this.$message.error(e.message)\r\n      }\r\n    },\r\n    async getShopEvalList () {\r\n      try {\r\n        const data = await shopService.getShopEvalList({\r\n          shopId: this.shopId,\r\n          tagId: this.currentEval,\r\n          page: this.evalPage,\r\n          size: this.evalPageSize\r\n        })\r\n        this.evalList = data.data\r\n        this.evalTotal = data.total\r\n      } catch (e) {\r\n        this.$message.error(e.message)\r\n      }\r\n    },\r\n    calcDate (date) {\r\n      return moment(date, 'YYYYMMDD').fromNow()\r\n    },\r\n    handlePageChanged (val) {\r\n      this.evalPage = val\r\n      this.getShopEvalList()\r\n    },\r\n    handleSizeChanged (val) {\r\n      this.evalPageSize = val\r\n      this.getShopEvalList()\r\n    },\r\n    handleTagClick (tagId) {\r\n      this.currentEval = tagId\r\n      this.getShopEvalList()\r\n    }\r\n  },\r\n  created () {\r\n    this.getShopEval()\r\n    this.getShopEvalList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n.eval-info {\r\n  h2 {\r\n    margin: 0;\r\n    text-align: center;\r\n    color: #f60;\r\n  }\r\n  .eval-avg {\r\n    margin: 0;\r\n    text-align: center;\r\n    font-size: 16px;\r\n  }\r\n  .rating {\r\n    font-size: 14px;\r\n    color: #666;\r\n    text-align: center;\r\n  }\r\n}\r\n.eval-tag {\r\n  margin-right: 10px;\r\n  margin-bottom: 10px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n.eval-list-item {\r\n  h3 {\r\n    margin: 0;\r\n    font-size: 14px;\r\n  }\r\n  .el-rate {\r\n    margin: 5px 0;\r\n  }\r\n  p {\r\n    margin: 0;\r\n    font-size: 14px;\r\n  }\r\n  .eval-date {\r\n    float: right;\r\n    font-size: 12px;\r\n    color: #666;\r\n  }\r\n}\r\n.img-list {\r\n  li {\r\n    display: inline-block;\r\n    overflow: hidden;\r\n    padding: 10px 10px;\r\n    .el-image {\r\n      box-shadow: 2px 2px 6px #bbb;\r\n      height: 88px;\r\n      width: 88px;\r\n      img {\r\n        border-radius: 5px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/shop"}]}