{"remainingRequest":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\blb-consumer-frontend\\src\\components\\shop\\ShopEval.vue?vue&type=style&index=0&id=5f211904&lang=less&scoped=true&","dependencies":[{"path":"D:\\project\\blb-consumer-frontend\\src\\components\\shop\\ShopEval.vue","mtime":1613365578288},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZXZhbC1pbmZvIHsNCiAgaDIgew0KICAgIG1hcmdpbjogMDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgY29sb3I6ICNmNjA7DQogIH0NCiAgLmV2YWwtYXZnIHsNCiAgICBtYXJnaW46IDA7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgfQ0KICAucmF0aW5nIHsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgY29sb3I6ICM2NjY7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICB9DQp9DQouZXZhbC10YWcgew0KICBtYXJnaW4tcmlnaHQ6IDEwcHg7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCiAgdHJhbnNpdGlvbjogYWxsIDAuMnM7DQp9DQouZXZhbC1saXN0LWl0ZW0gew0KICBoMyB7DQogICAgbWFyZ2luOiAwOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgfQ0KICAuZWwtcmF0ZSB7DQogICAgbWFyZ2luOiA1cHggMDsNCiAgfQ0KICBwIHsNCiAgICBtYXJnaW46IDA7DQogICAgZm9udC1zaXplOiAxNHB4Ow0KICB9DQogIC5ldmFsLWRhdGUgew0KICAgIGZsb2F0OiByaWdodDsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgY29sb3I6ICM2NjY7DQogIH0NCn0NCi5pbWctbGlzdCB7DQogIGxpIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBwYWRkaW5nOiAxMHB4IDEwcHg7DQogICAgLmVsLWltYWdlIHsNCiAgICAgIGJveC1zaGFkb3c6IDJweCAycHggNnB4ICNiYmI7DQogICAgICBoZWlnaHQ6IDg4cHg7DQogICAgICB3aWR0aDogODhweDsNCiAgICAgIGltZyB7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["ShopEval.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShopEval.vue","sourceRoot":"src/components/shop","sourcesContent":["<template>\r\n  <el-row :gutter='20'>\r\n    <el-col :span='18'>\r\n        <el-tag class=\"eval-tag\" type='primary' :effect='currentEval == -1 ?\"dark\":\"light\"' @click=\"handleTagClick(-1)\">全部评价({{allEvalSum}})</el-tag>\r\n        <el-tag class=\"eval-tag\"\r\n        v-for='item in shopEval.wordCloud'\r\n        :key='item.id'\r\n        :type=\"!item.positive?'info':'primary'\"\r\n        :effect=\"currentEval === item.id?'dark':'light'\"\r\n        @click=\"handleTagClick(item.id)\"\r\n        >{{item.content}}({{item.count}})</el-tag>\r\n        <el-divider></el-divider>\r\n        <ul class=\"eval-list\">\r\n          <li v-for=\"item in evalList\" :key=\"item.evalId\" class=\"eval-list-item\">\r\n            <el-row>\r\n              <el-col :span=\"2\">\r\n                <el-avatar>{{item.nickName}}</el-avatar>\r\n              </el-col>\r\n              <el-col :span=\"22\">\r\n                <span class=\"eval-date\">{{calcDate(item.createTime)}}</span>\r\n                <h3>{{item.phone}}</h3>\r\n                <el-rate :value=\"parseFloat(item.ranking)\" disabled></el-rate>\r\n                <p>{{item.content}}</p>\r\n                <ul class=\"img-list\">\r\n                  <li v-for=\"img in item.imgList\" :key=\"img + Math.random()\">\r\n                    <el-image\r\n                    :src=\"img\"\r\n                    :preview-src-list=\"item.imgList\"\r\n                    fit=\"cover\"\r\n                    />\r\n                  </li>\r\n                </ul>\r\n              </el-col>\r\n            </el-row>\r\n            <el-divider></el-divider>\r\n          </li>\r\n        </ul>\r\n        <el-pagination\r\n          style=\"text-align:center\"\r\n          @size-change=\"handleSizeChanged\"\r\n          background\r\n          @current-change=\"handlePageChanged\"\r\n          :current-page=\"evalPage\"\r\n          :page-sizes=\"[2, 10, 20, 30]\"\r\n          :page-size=\"evalPageSize\"\r\n          layout=\"prev, pager, next\"\r\n          :total=\"evalTotal\">\r\n        </el-pagination>\r\n    </el-col>\r\n    <el-col :span='6'>\r\n      <el-card class='eval-info'>\r\n        <h2>{{shopEval.rating}}</h2>\r\n        <p class='eval-avg'>综合评价</p>\r\n        <p class='rating'>高于周围{{shopEval.wingRate}}%的商家</p>\r\n      </el-card>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport shopService from '../../service/ShopService'\r\nimport moment from 'moment'\r\nexport default {\r\n  props: ['shopId'],\r\n  data () {\r\n    return {\r\n      shopEval: {},\r\n      evalList: [],\r\n      currentEval: -1,\r\n      evalPage: 1,\r\n      evalPageSize: 10,\r\n      evalTotal: 0\r\n    }\r\n  },\r\n  computed: {\r\n    allEvalSum () {\r\n      if (!this.shopEval.wordCloud) {\r\n        return 0\r\n      }\r\n      let sum = 0\r\n      for (let i = 0; i < this.shopEval.wordCloud.length; i++) {\r\n        sum += this.shopEval.wordCloud[i].count\r\n      }\r\n      return sum\r\n    }\r\n  },\r\n  methods: {\r\n    async getShopEval () {\r\n      try {\r\n        const shopEval = await shopService.getShopEval(this.shopId)\r\n        this.shopEval = shopEval\r\n      } catch (e) {\r\n        this.$message.error(e.message)\r\n      }\r\n    },\r\n    async getShopEvalList () {\r\n      try {\r\n        const data = await shopService.getShopEvalList({\r\n          shopId: this.shopId,\r\n          tagId: this.currentEval,\r\n          page: this.evalPage,\r\n          size: this.evalPageSize\r\n        })\r\n        this.evalList = data.data\r\n        this.evalTotal = data.total\r\n      } catch (e) {\r\n        this.$message.error(e.message)\r\n      }\r\n    },\r\n    calcDate (date) {\r\n      return moment(date, 'YYYYMMDD').fromNow()\r\n    },\r\n    handlePageChanged (val) {\r\n      this.evalPage = val\r\n      this.getShopEvalList()\r\n    },\r\n    handleSizeChanged (val) {\r\n      this.evalPageSize = val\r\n      this.getShopEvalList()\r\n    },\r\n    handleTagClick (tagId) {\r\n      this.currentEval = tagId\r\n      this.getShopEvalList()\r\n    }\r\n  },\r\n  created () {\r\n    this.getShopEval()\r\n    this.getShopEvalList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n.eval-info {\r\n  h2 {\r\n    margin: 0;\r\n    text-align: center;\r\n    color: #f60;\r\n  }\r\n  .eval-avg {\r\n    margin: 0;\r\n    text-align: center;\r\n    font-size: 16px;\r\n  }\r\n  .rating {\r\n    font-size: 14px;\r\n    color: #666;\r\n    text-align: center;\r\n  }\r\n}\r\n.eval-tag {\r\n  margin-right: 10px;\r\n  margin-bottom: 10px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n.eval-list-item {\r\n  h3 {\r\n    margin: 0;\r\n    font-size: 14px;\r\n  }\r\n  .el-rate {\r\n    margin: 5px 0;\r\n  }\r\n  p {\r\n    margin: 0;\r\n    font-size: 14px;\r\n  }\r\n  .eval-date {\r\n    float: right;\r\n    font-size: 12px;\r\n    color: #666;\r\n  }\r\n}\r\n.img-list {\r\n  li {\r\n    display: inline-block;\r\n    overflow: hidden;\r\n    padding: 10px 10px;\r\n    .el-image {\r\n      box-shadow: 2px 2px 6px #bbb;\r\n      height: 88px;\r\n      width: 88px;\r\n      img {\r\n        border-radius: 5px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}