{"remainingRequest":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\blb-consumer-frontend\\src\\components\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\blb-consumer-frontend\\src\\components\\Login.vue","mtime":1611473104209},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\blb-consumer-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgY29uc3VtZXJTZXJ2aWNlIGZyb20gJy4uL3NlcnZpY2UvQ29uc3VtZXJTZXJ2aWNlJw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICBjb25zdCBlbWFpbFZhbGlkYXRvciA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICgvXlx3KyhbLi1dP3crKSpAXHcrKFsuLV0/XHcrKSooLlx3ezIsM30pKyQvLnRlc3QodmFsdWUpKSB7DQogICAgICAgIGNhbGxiYWNrKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6YKu566x5qC85byP5LiN5q2j56GuIScpKQ0KICAgICAgfQ0KICAgIH0NCiAgICBjb25zdCBwaG9uZVZhbGlkYXRvciA9IChyb2xlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICgvXjFbMzQ1Njc4OV1cZHs5fSQvLnRlc3QodmFsdWUpKSB7DQogICAgICAgIGNhbGxiYWNrKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign5omL5py65Y+356CB5qC85byP5LiN5q2j56GuIScpKQ0KICAgICAgfQ0KICAgIH0NCiAgICBjb25zdCBwYXNzd29yZFZhbGlkYXRvciA9IChyb2xlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5yZWdpc3RlckZvcm0ucGFzc3dvcmQpIHsNCiAgICAgICAgY2FsbGJhY2soKQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfkuKTmrKHovpPlhaXnmoTlr4bnoIHkuI3kuIDoh7QhJykpDQogICAgICB9DQogICAgfQ0KICAgIHJldHVybiB7DQogICAgICBhY3RpdmVOYW1lOiAnbG9naW4nLA0KICAgICAgbG9naW5Gb3JtOiB7DQogICAgICAgIG5hbWU6ICcnLA0KICAgICAgICBwYXNzd29yZDogJycNCiAgICAgIH0sDQogICAgICBsb2dpbkZvcm1SdWxlczogew0KICAgICAgICBuYW1lOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeeZu+W9lei0puWPtycsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHBhc3N3b3JkOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0NCiAgICAgIH0sDQogICAgICByZWdpc3RlckZvcm06IHsNCiAgICAgICAgdXNlcm5hbWU6ICcnLA0KICAgICAgICBwYXNzd29yZDogJycsDQogICAgICAgIGVtYWlsOiAnJywNCiAgICAgICAgcGhvbmU6ICcnLA0KICAgICAgICByZXBlYXRQYXNzd29yZDogJycNCiAgICAgIH0sDQogICAgICByZWdpc3RlckZvcm1SdWxlczogew0KICAgICAgICB1c2VybmFtZTogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXnlKjmiLflkI0nLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICB7IG1pbjogMywgbWF4OiAyMCwgbWVzc2FnZTogJ+mVv+W6puWcqDMtMjAnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdLA0KICAgICAgICBlbWFpbDogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXpgq7nrrEnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICB7IHZhbGlkYXRvcjogZW1haWxWYWxpZGF0b3IsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHBhc3N3b3JkOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgIHsgbWluOiAzLCBtYXg6IDIwLCBtZXNzYWdlOiAn6ZW/5bqm5ZyoMy0yMCcsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIHJlcGVhdFBhc3N3b3JkOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgIHsgdmFsaWRhdG9yOiBwYXNzd29yZFZhbGlkYXRvciwgdHJpZ2dlcjogJ2JsdXInIH0NCiAgICAgICAgXSwNCiAgICAgICAgcGhvbmU6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5omL5py65Y+356CBJywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgICAgeyB2YWxpZGF0b3I6IHBob25lVmFsaWRhdG9yLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgbG9naW4gKCkgew0KICAgICAgdGhpcy4kcmVmcy5sb2dpbkZvcm0udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGNvbnN1bWVyU2VydmljZS5sb2dpbih0aGlzLmxvZ2luRm9ybS5uYW1lLCB0aGlzLmxvZ2luRm9ybS5wYXNzd29yZCkNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn55m75b2V5oiQ5YqfJykNCiAgICAgICAgICAgIC8vIOiuvue9rueZu+W9leeKtuaAgSDnlKjmiLfkv6Hmga8NCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0VXNlckluZm8nLCBkYXRhKQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRMb2dpblN0YXRlJywgdHJ1ZSkNCiAgICAgICAgICAgIC8vIOWFs+mXreW8ueeqlw0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdjbG9zZUxvZ2luUGFuZWwnKQ0KICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZS5tZXNzYWdlKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7flsIbkv6Hmga/loavlhpnlrozmlbQnKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgcmVnaXN0ZXIgKCkgew0KICAgICAgdGhpcy4kcmVmcy5yZWdpc3RlckZvcm0udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGNvbnN1bWVyU2VydmljZS5yZWdpc3Rlcih0aGlzLnJlZ2lzdGVyRm9ybSkNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhkYXRhLmdyZWV0aW5nICsgYCzmgqjmmK/mnKzns7vnu5/nrKwke2RhdGEudXNlck51bWJlcn3kuKrkvJrlkZhgKQ0KICAgICAgICAgICAgLy8g5YiH5o2i5Yiw55m75b2VdGFi5qCPDQogICAgICAgICAgICB0aGlzLmFjdGl2ZU5hbWUgPSAnbG9naW4nDQogICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlLm1lc3NhZ2UpDQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+WwhuS/oeaBr+Whq+WGmeWujOaVtCcpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <el-dialog\r\n    :title=\"activeName == 'login' ? '登录' : '注册'\"\r\n    :visible=\"$store.state.loginPanelShow\"\r\n    @close=\"$store.commit('closeLoginPanel')\"\r\n    width=\"25%\">\r\n      <el-tabs v-model=\"activeName\">\r\n        <el-tab-pane label=\"登录\" name=\"login\">\r\n          <el-form :model=\"loginForm\" :rules=\"loginFormRules\" ref=\"loginForm\" :label-position=\"'right'\" label-width=\"80px\">\r\n            <el-form-item label=\"登录账号\" prop=\"name\">\r\n              <el-input v-model=\"loginForm.name\" placeholder=\"用户名/手机/邮箱\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"password\">\r\n              <el-input v-model=\"loginForm.password\" placeholder=\"密码\" show-password clearable></el-input>\r\n            </el-form-item>\r\n          </el-form>\r\n           <div>\r\n            <el-button type=\"success\" style=\"width:100px;float:right\" @click=\"login\">登录</el-button>\r\n           </div>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"注册\" name=\"register\">\r\n          <el-form :model=\"registerForm\" :rules=\"registerFormRules\" ref=\"registerForm\" :label-position=\"'right'\" label-width=\"80px\">\r\n            <el-form-item label=\"用户名\" prop=\"username\">\r\n              <el-input v-model=\"registerForm.username\" placeholder=\"用户名\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"手机\" prop=\"phone\">\r\n              <el-input v-model=\"registerForm.phone\" placeholder=\"手机\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"邮箱\" prop=\"email\">\r\n              <el-input v-model=\"registerForm.email\" placeholder=\"邮箱\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"password\">\r\n              <el-input v-model=\"registerForm.password\" placeholder=\"密码\" show-password></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"确认密码\" prop=\"repeatPassword\">\r\n              <el-input v-model=\"registerForm.repeatPassword\" placeholder=\"确认密码\" show-password></el-input>\r\n            </el-form-item>\r\n          </el-form>\r\n           <div>\r\n            <el-button type=\"primary\" style=\"width:100px;float:right\" @click=\"register\">注册</el-button>\r\n           </div>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport consumerService from '../service/ConsumerService'\r\nexport default {\r\n  data () {\r\n    const emailValidator = (rule, value, callback) => {\r\n      if (/^\\w+([.-]?w+)*@\\w+([.-]?\\w+)*(.\\w{2,3})+$/.test(value)) {\r\n        callback()\r\n      } else {\r\n        callback(new Error('邮箱格式不正确!'))\r\n      }\r\n    }\r\n    const phoneValidator = (role, value, callback) => {\r\n      if (/^1[3456789]\\d{9}$/.test(value)) {\r\n        callback()\r\n      } else {\r\n        callback(new Error('手机号码格式不正确!'))\r\n      }\r\n    }\r\n    const passwordValidator = (role, value, callback) => {\r\n      if (value === this.registerForm.password) {\r\n        callback()\r\n      } else {\r\n        callback(new Error('两次输入的密码不一致!'))\r\n      }\r\n    }\r\n    return {\r\n      activeName: 'login',\r\n      loginForm: {\r\n        name: '',\r\n        password: ''\r\n      },\r\n      loginFormRules: {\r\n        name: [\r\n          { required: true, message: '请输入登录账号', trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' }\r\n        ]\r\n      },\r\n      registerForm: {\r\n        username: '',\r\n        password: '',\r\n        email: '',\r\n        phone: '',\r\n        repeatPassword: ''\r\n      },\r\n      registerFormRules: {\r\n        username: [\r\n          { required: true, message: '请输入用户名', trigger: 'blur' },\r\n          { min: 3, max: 20, message: '长度在3-20', trigger: 'blur' }\r\n        ],\r\n        email: [\r\n          { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n          { validator: emailValidator, trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' },\r\n          { min: 3, max: 20, message: '长度在3-20', trigger: 'blur' }\r\n        ],\r\n        repeatPassword: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' },\r\n          { validator: passwordValidator, trigger: 'blur' }\r\n        ],\r\n        phone: [\r\n          { required: true, message: '请输入手机号码', trigger: 'blur' },\r\n          { validator: phoneValidator, trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    login () {\r\n      this.$refs.loginForm.validate(async valid => {\r\n        if (valid) {\r\n          try {\r\n            const data = await consumerService.login(this.loginForm.name, this.loginForm.password)\r\n            this.$message.success('登录成功')\r\n            // 设置登录状态 用户信息\r\n            this.$store.commit('setUserInfo', data)\r\n            this.$store.commit('setLoginState', true)\r\n            // 关闭弹窗\r\n            this.$store.commit('closeLoginPanel')\r\n          } catch (e) {\r\n            this.$message.error(e.message)\r\n          }\r\n        } else {\r\n          this.$message.error('请将信息填写完整')\r\n        }\r\n      })\r\n    },\r\n    register () {\r\n      this.$refs.registerForm.validate(async valid => {\r\n        if (valid) {\r\n          try {\r\n            const data = await consumerService.register(this.registerForm)\r\n            this.$message.success(data.greeting + `,您是本系统第${data.userNumber}个会员`)\r\n            // 切换到登录tab栏\r\n            this.activeName = 'login'\r\n          } catch (e) {\r\n            this.$message.error(e.message)\r\n          }\r\n        } else {\r\n          this.$message.error('请将信息填写完整')\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n"]}]}